\section{Discussion}

While prediction errors of the point estimates produced by MAP and HMC are very similar as measured by 3 losses common to pharmacokinetic research, they each produce very different estimates of uncertainty.  Such estimates are necessary for decision making under uncertainty, where an expected loss is computed over a posterior distribution.  In this study, for a given dose, MAP assigns a significant amount of probability mass to concentrations which are far lower than the concentrations considered plausible by HMC.  The extent to which this discrepancy would change decisions depends on the loss function, but we see substantial differences in our two example experiments for personalized dosing.  The difference in uncertainty between MAP and HMC results in small disagreement for dose size for the majority of patients, but very large disagreement for a sizable minority of about 20\%. The observed difference in uncertainty for the concentration function between MAP and HMC are likely due to discrepancies in uncertainty over the individual PK parameters: Each of the 19 pseudopatients in \cref{fig:fig6} see MAP and HMC disagree strongly on posterior uncertainty for the parameters $k_a$ and $k_a$.  MAP lends credence to higher values of $k_a$ and lower values of $k_e$ as compared to HMC. The differences in uncertainty in these parameters is likely the cause of the observed difference in uncertainty in concentration levels. This translates into much wider equal-tailed posterior intervals for concentration using MAP, with 19 out of 100 patients having an MAP equal tailed posterior credible interval at least 50\% as wide or wider at their widest point than their HMC equal tailed posterior interval. For each of these 19 patients, MAP appears to have a lower interval estimate far below that of HMC, making it appear as if lower predicted concentrations are probable. This in can make a given proposed dose appear risky in terms of allowing concentration to fall too low; which in turn leads to an increase in recommended dose when the model is asked for a dose that bounds this risk.

While the posterior distribution for this model is too complex to be analyzed analytically, there are good theoretical reasons to prefer HMC over MAP when analysts seek the posterior expectation of some function of parameters. These reasons are nicely summarized by \cite{Betancourt2017-ak}, but can be explained by the fact that expectations are computed over volumes, and in high dimensional space there exists more volume away from the mode than in a neighbourhood around it. Because the volume near the mode is so small, these regions of parameter space contribute negligibly to expectations.  Instead, regions of parameter space where the product of probability density and volume is large (i.e. \textit{the typical set}) should contribute more to expectations, and this is where our chosen method should be focusing its computational power.  Hamiltonian Monte Carlo does exactly this, and thus we prefer it to Maximum A Posteriori.

Neither HMC nor MAP provide perfect representations of the posterior, and discrepancies between the two methods are expected. However, the degree of discrepancy observed in this study and its impact on dosing decisions reveals that these techniques are not interchangeable. On reason for the observed difference might be an insufficient number of observations.  However, with 24 equally-spaced observations per each of the 100 simulated patients, this simulation study represents an extremely optimistic (and likely unrealistic) best case scenario. Even specialized studies of pharmacokinetics would collect fewer samples from fewer patients, and even less data collection is practical in clinical practice. Hence, even if MAP and HMC were to converge to each other with enough data, this amount of data is not available in practice. Another possible reason could be the chosen priors and/or the likelihood, but the model used was identical for both inference methods and had strong priors informed by existing pharmacokinetic data.  We note that our proposed model does not account for patient covariates (e.g. weight, BMI, creatinine, etc).  Our model could be extended to include covariates as input to the model to further personalize dose. Although our models did not account for patient covariates, a secondary analysis was performed in which patient level pharmacokinetic parameters were regressed onto patient covariates.  In this analysis, we observed the same disagreement in model uncertainty as shown in \cref{fig:fig6}.  Because the uncertainty directly affects dosing decisions, we believe a model sampled using MAP which included covariates would also show similar calibration relative to a model sampled using HMC.

%By performing the summarization of the posterior using the same data, generated from a model fit on real pharmacokinetic observations, and using strong and informative priors, we strongly believe that this observed difference is due to the differences between methods. However, that is not to say that this is the case across all models and prior configurations.  The prior we propose is purposefully uninformative about the ratio of the elimination and absorption rate constants, so as to investigate a likely scenario in which prior information is available for some but not all of the model parameters.  Were this prior to be strongly informed, we highly suspect that the observed differences between HMC and MAP would attenuate.  This raises important questions about model specification and the degree to which practitioners can afford to be uncertain about model parameters.

\section{Conclusion}
We have presented a new Bayesian model for apixaban pharmacokinetics and an induction dosing model for apixaban based on desired trough concentration level after a first dose. We have also presented a simulation study demonstrating that inferences made via MAP and HMC lead to very different dosing strategies; from this simulation study, we derive some general conclusions and guidelines for Bayesian pharmacokinetic modelling as applied to precision medicine.

Bayesian modelling using informative priors provides a practical approach for developing personalized dosing strategies when data are limited. However, the evaluation of Bayesian models, particularly with informative priors, typically focuses on the model itself - are the priors plausible? Do posterior predictive checks look appropriate? In this work, we have demonstrated that the inference technique can have an impact on decision making that is as important as model fidelity, even when the impact on point prediction quality is minimal. Specifically, we have shown that MAP-based inference, which is very commonly used in pharmacokinetics, can lead to very different personalized dosing decisions than HMC-based inference, even in a well-validated model.

Studies using MAP for Bayesian inference in pharmacokinetic models have been published as recently as 2020.  The speed and similarity to maximum likelihood makes MAP an attractive and familiar approach as compared to HMC, which can take several minutes to return samples and can use quite complex mechanisms to draw from the posterior. The aforementioned studies have largely focused on point predictions of latent concentrations where, as we have shown, MAP and HMC yield similar results. However, when uncertainty information is used for decision-making, MAP and HMC can lead to very different outcomes.

We recommend that if practitioners do use MAP, that they also compare model results with HMC.  Libraries exist to perform HMC in a variety of languages including R, python, and Julia, making HMC widely accessible.  Use of these libraries has the added benefit of making analysis more transparent and reproducible for the community at large.

